<!DOCTYPE html>
<html xmlns:th="http://thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>중복확인</title>
<script>
	function validation() {
		let id = document.getElementById("idCheck");
		/* document.getElementById("checkResult").style.display=""; */
		
		let idCk = /^[a-z0-9]$/; // 영어 소문자, 숫자만 입력 가능 + 영어로 시작
		let lengthCk = /{6, 12}/ // 길이는 6~12자
		
		/*
		[ JS 유효성 검사 ]
		ex)	let checkEng = /^[a-zA-z0-9]{4,12}$/; 
		
		/   : 자바스크립트의 정규표현식의 처음과 끝을 의미한다.
		[ ] : 문자셋이다. 
			  예를 들면 [a-z]라고 적을경우 정규표현식에 만족해야하는 값들은 반드시 a~z사이의 값만 넣을 수 있다.
		^   : 문장의 처음을 뜻한다.
		$ : 문장의 마지막을 뜻한다.
		{ } : 문자열 길이를 뜻한다. 예를 들어 {4,12}일 경우 최소 길이 4, 최대 길이 12이다.
		
		*/

		
		if (id.value.length == 0) {
			alert("아이디를 입력하세요");
			return false;
		}
		/* if(!idCk.test(id.value)){
			alert("아이디는 소문자 영어와 숫자의 조합, 영어로 시작");
			return false;
		} */
		/* if(!lengthCk.test(id.value)){
			alert("아이디는 6 ~ 12자");
			return false;
		} */
		
	}
	
	function inputId(checkedId){
		opener.document.getElementById("memberid").value = checkedId;
		// opener == 기존 창에서 열린 새 창이 있는 경우, 기존 창을 의미
		//			 이 경우 새로 열린 창은 this
		this.close();
		// 현재 창 닫기(열린 새 창)
	}
</script>
<style>
	div {
		text-align : center;
	}
	span {
		color : red;
	}
</style>
</head>
<body>
	<div>
		<header>
			<h1>[ID 중복 확인]</h1>
		</header>
		<br>
		<section>
			<form action="" method="post" onsubmit="return validation()">
			<!-- joinMember.html에서 idCheck.html을 열때 window.open으로 지정한 경로를 Controller에서
				 PostMapping으로 받는중이므로 action을 따로 써주지 않아도 됨  -->
				<label for="idCheck">ID 입력</label> 
					<input id="idCheck" name="idCheck" type="text" placeholder="ID를 입력하세요"> 
					<input id="checkIt" type="submit" value="검색">
			</form>
			
				<p th:text="${result}">중복 확인 결과 : true == 중복 X / false == 중복</p>
				<p th:text="${checkedId}">중복 여부 확인된 ID</p>
				
			<div th:if="${checkedId != null}"> <!-- checkedId가 null이 아닌 경우에만 div 태그의 값 보여줌 -->
				<div th:if="${result}"> <!-- th:if="${checkedId != null}"의 결과가 true -->
					<p>[ <span th:text="${checkedId}"></span> ] 는 사용할 수 있는 ID입니다</p>
					<input type="button" value="ID 사용하기" 
						th:checkedId ="${checkedId}" 
						th:onclick="inputId(this.getAttribute('checkedId'))">
				</div>
				<div th:if="${not result}"> <!-- thymeleaf에선 !를 not으로 씀 -->
					<p>[ <span th:text="${checkedId}"></span> ] 는 이미 사용중인 ID입니다</p>
				</div>	
			</div>
		</section>
	</div>
</body>
</html>