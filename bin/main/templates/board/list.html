<!DOCTYPE html>
<html xmlns:th="http://thymeleaf.org"
	xmlns:sec="http://thymeleaf.org/extras/spring-security">
<head>
<meta charset="UTF-8">
<title>게시판</title>
<style>
h1, td {
	text-align: center;
}

table {
	margin: 0 auto;
	width: 150vh;
}

th.theader {
	background-color: azure;
}

td#title:hover, td#writer:hover {
	background-color: pink;
}

td#title:active, td#writer:active {
	background-color: yellowgreen;
}

th#write {
	text-align: right;
}

a{
	text-decoration: none;	
}

a#selectable {
	text-decoration: none;
}

a#selectable:hover {
	text-decoration: underline;
}

p {
	margin: 0 0;
}
form#logoutBtn {
	text-align : right;
}
div.navigator {
	width: 600px;
	text-align: center;
	margin: auto;
	margin-top: 20px;
}
</style>
<script>
	function toHome(){
		location.href="/page";
	}
	function writeContext(){
		location.href="/page/board/write";
	}
	function pagingFormSubmit(currentPage){
		let form = document.getElementById('pagingForm');
		let page = document.getElementById('page');
		page.value = currentPage; // 전달받은 페이지 번호를 폼에 저장
		form.submit(); // page, type, searchWord 전송
	}
	function login(){
		location.href="/page/memberView/loginForm";	
	}
</script>
</head>
<body>
	<header>
		<form th:action="@{/logout}" method="post" id="logoutBtn" 
				sec:authorize="isAuthenticated()">
			<input type="submit" value="로그아웃">
		</form>
		<h1>[ 게시판 ]</h1>
		<input type="button" value="HOME" 
			sec:authorize="isAuthenticated()" onclick="toHome()"> 
		<input type="button" value="HOME"
			sec:authorize="not isAuthenticated()" onclick="toHome()"> <br>
		<div>
			전체 글 수 : <span th:text="${navi.totalRecordsCount}"></span>
			<br>
			<span th:text="|${navi.currentPage} / ${navi.totalPageCount} page|"></span>
			<br>
			[[${navi}]]
		</div>
		<hr>
	</header>
	<table>
		<tr>
			<th colspan="5" id="write">
				<input type="button" value="글쓰기"
					sec:authorize="isAuthenticated()" onclick="writeContext()">
				<input type="button" value="로그인"
					sec:authorize="not isAuthenticated()" onclick="login()"> 
			</th>
		</tr>
		<tr>
			<th class="theader">번호</th>
			<th class="theader">제목</th>
			<th class="theader">작성자</th>
			<th class="theader">조회수</th>
			<th class="theader">등록일</th>
		</tr>
		<tr th:each="list : ${list}">
			<td><p th:text="${list.boardnum}">글 번호</p></td>
			<td id="title">
				<a th:text="${list.title}" id="selectable"
					th:href="@{/board/read(boardnum=${list.boardnum})}">제목</a>
			</td>
			<td id="writer">
				<p th:text="${list.memberid}" th:mId="${list.memberid}">작성자</p>
			</td>
			<td><p th:text="${list.hits}">조회수</p></td>
			<td><p th:text="${list.input}">등록일</td>
		</tr>
		<tr>
			<td colspan="5">
				<div class="navigator">
				<!-- 페이지 이동 링크 -->
					<a th:href="|javascript:pagingFormSubmit(${navi.currentPage - navi.pagePerGroup})|">◁◁</a>
					<a th:href="|javascript:pagingFormSubmit(${navi.currentPage - 1})|">◀</a>
					<span th:each="counter : ${#numbers.sequence(navi.startPageGroup, navi.endPageGroup)}">
						<!-- for문에서 제어 변수 i, j 선언한 것과 같은 결과 
							 ==> counter는 사용자 지정 변수명  #numbers.sequence라는 배열의 값을 대입 -->
						<th:block th:if="${counter == navi.currentPage}"><b></th:block>
						<!-- th:block == 다른 태그 없이 타임리프를 사용하려고 할 때 사용
								th:if 의 조건이 참이면 th:block 부분만 없어짐 ==> <b>가 남음
								현재 페이지가 counter와 일치하면 굵게 -->
						<a th:text="${counter}" th:href="|javascript:pagingFormSubmit(${counter})|"></a>&nbsp; 
						<th:block th:if="${counter == navi.currentPage}"></b></th:block>
					</span> 
					<a th:href="|javascript:pagingFormSubmit(${navi.currentPage + 1})|">▶</a> 
					<a th:href="|javascript:pagingFormSubmit(${navi.currentPage + navi.pagePerGroup})|">▷▷</a> <br> <br>
				</div>
			</td>
		</tr>		
		<tr>
			<td colspan="5">
				<hr>
				<div class="navigator">
					<form id="pagingForm" th:action="@{/board/list}" method="GET">
						<input type="hidden" name="page" id="page">
						<!-- 페이지 이동을 위한 것 -->
						<select name="type" id="type"> 
							<!-- type이라는 변수에 option태그 중 선택된 value를 담아 전달 -->
							<option class="selc" value="title" th:selected="${type} == 'title'">제목</option>
							<option class="selc" value="contents" th:selectd="${type} == 'contents'">본문</option>
							<option class="selc" value="memberid" th:selected="${type} == 'memberid'">아이디</option>
							<option class="selc" value="all" th:selected="${type} == 'all'">전체</option>
						</select> 
						<input type="text" name="searchWord" placeholder="입력" th:value="${searchWord}"> 
						<input type="button" onclick="pagingFormSubmit(1)" value="검색">
							<!-- onclick의 function의 parameter 1 == 1페이지를 보고 싶음 
								 검색 결과의 1번째 페이지를 볼 것 -->
							<!-- 보려는 페이지 번호 선택시 검색 창에 해당 페이지 값을 넣어서 전송해 이동 -->
					</form>
				</div>
			</td>
		</tr>
	</table>
</body>
</html>